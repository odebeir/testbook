---
redirect_from:
  - "/features/02-low-level-image-processing/04-image-restoration"
interact_link: content/features/02-Low-level_image_processing/04-Image_restoration.ipynb
kernel_name: python3
has_widgets: false
title: |-
  Image restoration
prev_page:
  url: /features/02-Low-level_image_processing/03-Non_linear_filtering.html
  title: |-
    Non-linear filtering
next_page:
  url: /features/02-Low-level_image_processing/05-Edge_detection.html
  title: |-
    Edge detection
comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">HTML</span><span class="p">,</span><span class="n">Image</span><span class="p">,</span><span class="n">SVG</span><span class="p">,</span><span class="n">YouTubeVideo</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Image-restoration">Image restoration<a class="anchor-link" href="#Image-restoration"> </a></h1><p>Image acquisition is rarely perfect,  physics or external condition may deform the image being acquired, here are some example of typicall problems:</p>
<h2 id="Deformation-model">Deformation model<a class="anchor-link" href="#Deformation-model"> </a></h2><p>The original image is $f(x,y)$ undergoes a deformation, given by $H$, and an additive noise $\eta(x,y)$ the acquired image is $g(x,y)$.</p>
<p>The restoration problem can be stated as follow:</p>
<p>how to recover a good approximation of $f(x,y)$ from $g(x,y)$?</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;http://homepages.ulb.ac.be/~odebeir/data/restauration.png&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="../../images/features/02-Low-level_image_processing/04-Image_restoration_2_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some examples:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$g(x,y) = H[f(x,y)] + \eta(x,y)$$<p>$H$ properties:</p>
<ul>
<li>linear</li>
</ul>
$$ H[k_1 f_1(x,y) + k_2 f_2(x,y)] = k_1 H[f_1(x,y)] + k_2 H[f_2(x,y)]$$<ul>
<li>additive</li>
</ul>
$$ H[f_1(x,y) + f_2(x,y)] = H[f_1(x,y)] + H[f_2(x,y)]$$<ul>
<li>homogeneous</li>
</ul>
$$ H[k_1 f_1(x,y)] = k_1 H[f_1(x,y)]$$<ul>
<li>spatially invariant</li>
</ul>
$$ H[f(x-\alpha,y-\beta)] = g(x-\alpha,y-\beta)$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Point-Spread-Function-(PSF)">Point Spread Function (PSF)<a class="anchor-link" href="#Point-Spread-Function-(PSF)"> </a></h2><p>We can rewrite $f(x,y)$ as a sum of Dirac function.</p>
$$f(x,y) = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty} f(\alpha,\beta) \, \delta(x-\alpha,y-\beta) \, d\alpha \, d\beta$$<p>if there is no addiditive noise:</p>
$$\begin{eqnarray}g(x,y) &amp;=&amp; H[f(x,y)] \\ \\
&amp;=&amp; H \big[ \int_{-\infty}^{\infty}\int_{-\infty}^{\infty} f(\alpha,\beta) \, \delta(x-\alpha,y-\beta) \, d\alpha \, d\beta \, \big] 
\end{eqnarray}$$<p>by linearity property:</p>
$$g(x,y) = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty} H \big[f(\alpha,\beta) \, \delta(x-\alpha,y-\beta)\big] \, d\alpha \, d\beta $$<p>$f(\alpha,\beta)$ is independant of $x$ and $y$:</p>
$$g(x,y) = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f(\alpha,\beta)\, H \big[ \, \delta(x-\alpha,y-\beta)\big] \, d\alpha \, d\beta $$<p>the impulse response of $H$, also known as point spread function (PSF),  is:</p>
$$h(x,\alpha,y,\beta) = H\big[ \delta(x-\alpha,y-\beta)\big]$$<p>after substitution we have:</p>
$$g(x,y) = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f(\alpha,\beta)\, h(x,\alpha,y,\beta) \, d\alpha \, d\beta $$<p>this expression means that, if the response H of an impulse is known, the response of any input $f(\alpha,\beta)$ is known.</p>
<p>if $h$ is spatially invariant (see above):</p>
$$g(x,y) = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f(\alpha,\beta)\, h(x-\alpha,y-\beta) \, d\alpha \, d\beta$$<p>by adding the noise:</p>
$$g(x,y) = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f(\alpha,\beta)\, h(x-\alpha,y-\beta) \, d\alpha \, d\beta + \eta(x,y)$$<blockquote><p>see also:</p>
<ul>
<li><a href="../00-Preface/06-References.ipynb#[DIP]">DIP</a> p254</li>
</ul>
</blockquote>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Restoration">Restoration<a class="anchor-link" href="#Restoration"> </a></h2><h3 id="inverse-filtering">inverse filtering<a class="anchor-link" href="#inverse-filtering"> </a></h3><p>If noise is negligeable and PSF is known (in the Fourier domain):</p>
$$\begin{eqnarray}
\hat F(u,v) &amp;=&amp; \frac{G(u,v)}{H(u,v)}\\
\hat f(x,y) &amp;=&amp; \mathcal F^{-1} \big[ \hat F(u,v) \big]\\
            &amp;=&amp; \mathcal F^{-1} \big[\frac{G(u,v)}{H(u,v)}\big]
\end{eqnarray}
$$<p>else:</p>
$$\hat F(u,v) = F(u,v) + \frac{N(u,v)}{H(u,v)}$$<p>and noise is increasing when $H$ is low, restoration is limited where $H$ is big.</p>
<p>if define a restoration transform $M(u,v)$ as:</p>
$$\hat F(u,v) = (G(u,v)+N(u,v)) M(u,v)$$<p>one can use:</p>
$$M(u,v) = \begin{cases}1/H(u,v),\, \qquad &amp; u^2+v^2 \le&amp; w_0 ^2\\
1, \qquad &amp; u^2+v^2 &gt;&amp; w_0 ^2
\end{cases}
$$<p>with $w_0$ being a distance to the origin in the Fourier space.</p>
<blockquote><p>see also:</p>
<ul>
<li><a href="../00-Preface/06-References.ipynb#[DPP]">DPP</a> p276</li>
</ul>
</blockquote>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Wiener-filtering">Wiener filtering<a class="anchor-link" href="#Wiener-filtering"> </a></h3><p>To avoid arbitrary setting of a parameter for theinverse transform such as $w_0$, one can use the Wiener approach wich consists in minimizing by least square some error function.</p>
<p>Without going into the details, the restoration transform is:</p>
$$M(u,v) = \frac{H^*(u,v)}{|H(u,v)|^2+\frac{S_{\nu \nu}(u,v)}{S_{gg}(u,v)}}$$<p>where $H^*(u,v)$ is the complex conjugate of $H(u,v)$,</p>
<p>$S_{\nu \nu}(u,v)$ is the spectral density of the noise and</p>
<p>$S_{gg}(u,v)$ is the spectral density of the degraded image.</p>
<blockquote><p>see also:</p>
<ul>
<li><a href="../00-Preface/06-References.ipynb#[IPAMV]">IPAMV</a> p107</li>
</ul>
</blockquote>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Blind-deconvolution">Blind deconvolution<a class="anchor-link" href="#Blind-deconvolution"> </a></h3><p>If PSF in unknown, is has to be estimated. This is called blind deconvolution.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;http://bigwww.epfl.ch/algorithms/deconvolutionlab/meta/splash.png&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="../../images/features/02-Low-level_image_processing/04-Image_restoration_9_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><sup><a href="http://bigwww.epfl.ch/algorithms/deconvolutionlab/">image source</a></p>

</div>
</div>
</div>
</div>

 

