---
redirect_from:
  - "/features/06-object-feature-extraction/02-contour-features"
interact_link: content/features/06-Object_feature_extraction/02-Contour_features.ipynb
kernel_name: python3
has_widgets: false
title: |-
  Contour features
prev_page:
  url: /features/06-Object_feature_extraction/01-Statistical_features.html
  title: |-
    Statistical features
next_page:
  url: /features/06-Object_feature_extraction/03-Moments.html
  title: |-
    Moments
comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">HTML</span><span class="p">,</span><span class="n">Image</span><span class="p">,</span><span class="n">SVG</span><span class="p">,</span><span class="n">YouTubeVideo</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Contour-features">Contour features<a class="anchor-link" href="#Contour-features"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="chain-code-algorithm">chain code algorithm<a class="anchor-link" href="#chain-code-algorithm"> </a></h2><p>Chain code algorithm is a method that describes the contour of a connected set as an ordered set of pixels (see below).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;http://homepages.ulb.ac.be/~odebeir/data/chain.png&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="../../images/features/06-Object_feature_extraction/02-Contour_features_3_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The algorithm starts from an arbitrary pixel of the contour, e.g. found by rasterazing the image, the first object point detected being used.</p>
<p>at each iteration on try to find the next border pixel, the order of test is givenby the arrows in the upper right corner, starting from the direction just after the direction of arrival, i.e. the first direction(3) correspond to the first detected object pixel starting from (1) because (1) is the first direction after (0) which is the direction of 'arrival' of the raster. The new search position is given by :</p>
$$mod_7 (n+5)$$<p>so here the next search direction is</p>
$$mod_7 (3+5) = 1$$<p>for the second step, the found direction is (2), the next search direction is</p>
$$mod_7 (2+5) = 0$$<p>the process is iterated until the first pixel is reached again.</p>
<p>Polygon area and centroid can be computed from the chain code, if $(x_i,y_i)$ if the sequence of object contour,</p>
<p>for a chain of $n$ pixels, the area is</p>
$$Area = \frac{\sum_{i=0}^{n-1}(x_i+x_{mod_n(i+1)})(y_1-y_{mod_n(i-1)})}{2} $$<p>and centroïd is</p>
$$g_x = \frac{\sum_{i=0}^{n-1}(x_i+x_{mod_n(i+1)})^2(y_1-y_{mod_n(i-1)})^2}{Area} $$$$g_y = \frac{\sum_{i=0}^{n-1}(y_i+y_{mod_n(i+1)})^2(x_1-x_{mod_n(i-1)})^2}{Area} $$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>see also:</p>
<ul>
<li>Chain coding <a href="../00-Preface/06-References.ipynb#[DIP]">DIP</a> p484</li>
</ul>
</blockquote>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="polygonal-approximation">polygonal approximation<a class="anchor-link" href="#polygonal-approximation"> </a></h2><p>tbd...</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;http://homepages.ulb.ac.be/~odebeir/data/polygon.png&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="../../images/features/06-Object_feature_extraction/02-Contour_features_7_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2D-shape-descriptors-(contours)">2D shape descriptors (contours)<a class="anchor-link" href="#2D-shape-descriptors-(contours)"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Form-factor">Form factor<a class="anchor-link" href="#Form-factor"> </a></h3>$$Formfactor = \frac {4 \pi Area}{Perimeter} $$<h3 id="Convexity">Convexity<a class="anchor-link" href="#Convexity"> </a></h3>$$Convexity = \frac {Convex Perimeter}{Perimeter} $$$$Solidity = \frac {Area}{Convex Area} $$<h3 id="Moments">Moments<a class="anchor-link" href="#Moments"> </a></h3><p>One define moments such as ($f$ is considered here as a constant e.g. $1$)</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$ m_{pq} = \sum_{p= -\infty}^{+\infty}\sum_{q=-\infty}^{+\infty} x^p \; y^q \; f(x,y) $$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>moments are centralized with respect to the object centroïd</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$ \mu_{pq} = \sum_{p= -\infty}^{+\infty}\sum_{q=-\infty}^{+\infty} (x-\bar x)^p \; (y-\bar y)^q \; f(x,y) $$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>principal direction is given by</p>
$$\theta = \tan^{-1} \big(\frac{2\;\mu_{11}}{\mu_{20}-\mu_{02}}\big)$$$$
M = 
\begin{bmatrix}
    \mu_{20}       &amp; \mu_{11} \\
    \mu_{11}       &amp; \mu_{02} \\
\end{bmatrix}
$$<p>eigen values of $M$ are</p>
$$
\lambda_i = \frac{\mu_{20} + \mu_{02}}{2}  \pm \frac{\sqrt{4{\mu}_{11}^2 + ({\mu}_{20}-{\mu}_{02})^2  }}{2}
$$<p><strong>Eccentricity</strong> is given by</p>
$$\sqrt{1 - \frac{\lambda_2}{\lambda_1}}$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Aspect-ratio">Aspect ratio<a class="anchor-link" href="#Aspect-ratio"> </a></h3><p>The aspect ratio is given by the ratio between major and minor axes. The major axis is length of the major axis of the ellipse that has the same normalized second central moments as the shape, similarily, the minor axis is the length of the ellipse mino axis.</p>
$$Aspect Ratio = \frac {Max\: diameter}{Min\: diameter} $$<p>The equivallent diameter is the diameter of the disk having the same area.</p>
$$Eq.dia. =  \sqrt { \frac 4 \pi Area} $$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>see also:</p>
<ul>
<li>2D shape descriptors (contours) <a href="../00-Preface/06-References.ipynb#[DIP]">DIP</a> p.499 , <a href="../00-Preface/06-References.ipynb#[IPH]">IPH</a> p.490</li>
</ul>
</blockquote>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fourier-contour-description">Fourier contour description<a class="anchor-link" href="#Fourier-contour-description"> </a></h2><p>Contour can be seen as a 1D periodic function, e.g. by taking the distance to the centroïd as a function of an angle (see below).
The circle has obviously a constant radius whereas the square presents a variable distance...</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;http://homepages.ulb.ac.be/~odebeir/data/unwrapped.png&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="../../images/features/06-Object_feature_extraction/02-Contour_features_17_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Still, there is a problem when $r(\theta)$ is not a function, as illustrated below, for a same $\theta$, there is two different $r(\theta)$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;http://homepages.ulb.ac.be/~odebeir/data/unwrap2.png&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="../../images/features/06-Object_feature_extraction/02-Contour_features_19_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One solution, is to use the curvilinear coordinate along the contour and to express the radius with respect to that coordinate.</p>
<p>In the example below, one use the distance to the centroid of each contour pixel (chain) as a 1D contour description.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">skimage.morphology</span> <span class="k">import</span> <span class="n">disk</span><span class="p">,</span> <span class="n">square</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">skimage.measure</span> <span class="k">import</span> <span class="n">label</span><span class="p">,</span> <span class="n">regionprops</span><span class="p">,</span> <span class="n">find_contours</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">40</span><span class="p">,</span><span class="mi">80</span><span class="p">))</span>
<span class="n">im</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="o">+</span><span class="mi">21</span><span class="p">,</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="o">+</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">disk</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">im</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="o">+</span><span class="mi">21</span><span class="p">,</span><span class="mi">50</span><span class="p">:</span><span class="mi">50</span><span class="o">+</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">square</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>

<span class="n">lab</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span class="n">props</span> <span class="o">=</span> <span class="n">regionprops</span><span class="p">(</span><span class="n">lab</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">lab</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span>
    <span class="n">perim</span> <span class="o">=</span> <span class="n">find_contours</span><span class="p">(</span><span class="n">lab</span><span class="p">,</span><span class="n">obj</span><span class="o">.</span><span class="n">label</span><span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">obj</span><span class="o">.</span><span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">perim</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">perim</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/features/06-Object_feature_extraction/02-Contour_features_21_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;disk&#39;</span><span class="p">,</span><span class="s1">&#39;square&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">props</span><span class="p">):</span>
    <span class="n">perim</span> <span class="o">=</span> <span class="n">find_contours</span><span class="p">(</span><span class="n">lab</span><span class="p">,</span><span class="n">obj</span><span class="o">.</span><span class="n">label</span><span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="n">perim</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">centroid</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xy</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">xy</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;position on the contour&#39;</span><span class="p">)</span>    
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;distance to centroid&#39;</span><span class="p">)</span>    
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/features/06-Object_feature_extraction/02-Contour_features_22_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the example above, the disk exhibits an irregular profile due to its discrete representation.</p>
<p>The 1D signalm obtained are periodic by definition. Let's compute a Fourier transform on them.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>from numpy.fft import fft, fftshift
plt.figure(figsize=[20,3])
for i,obj in enumerate(props):
    perim = find_contours(lab,obj.label-1)[0]
    xy = perim - obj.centroid
    r = np.sqrt(xy[:,0]<strong>2+xy[:,1]</strong>2)<br>
    R = fft(r)
    plt.subplot(2,1,i+1)
    plt.plot(np.power(fftshift(R),2),label=labels[i])</p>

<pre><code>plt.legend(loc=0);
plt.gca().set_ylim([0,1000])
plt.gca().set_xlim([0,r.shape[0]])</code></pre>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We see that the Fourier power spectrum of the circle is almost in the continuous part (zero frequency is centered). On the contrary, the square exhibits an important contribution at a frequency corresponding to the oscillations.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fractal-analysis">Fractal analysis<a class="anchor-link" href="#Fractal-analysis"> </a></h2><p>The measure of a length is related to the scale used. If the scale is small, the details measured are more numerous and the overall length is higher. In many situations the dependency between scale $\lambda_i$ and total length $L_2$ the following equation is verified (with a constant $f$) :</p>
$$ \log L_2(X,\lambda_i) = f \; \log \lambda_i $$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>see also:</p>
<ul>
<li>Minkowski fractal dimension {% cite russ2016image %} p442</li>
</ul>
</blockquote>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="References">References<a class="anchor-link" href="#References"> </a></h3><p>{% bibliography --cited %}</p>

</div>
</div>
</div>
</div>

 

